# Requirements Document

## Introduction

유튜브소설어시스트는 유튜브 소설 제작을 위한 웹 애플리케이션으로, 사용자가 소설별로 프로젝트를 관리하고 각 소설 내에서 등장인물과 장면들을 체계적으로 구성할 수 있는 도구입니다. 현재 로컬스토리지 기반의 저장 시스템을 가지고 있으며, 소설 단위의 계층적 데이터 관리와 파일 시스템 기반의 저장 및 불러오기 기능이 필요합니다.

## Requirements

### Requirement 1

**User Story:** 사용자로서, 개별 소설 프로젝트를 완전한 형태로 저장하고 싶습니다. 그래야 소설별로 데이터를 백업하고 다른 환경에서도 사용할 수 있습니다.

#### Acceptance Criteria

1. WHEN 사용자가 특정 소설의 "소설 저장" 버튼을 클릭 THEN 시스템은 해당 소설의 모든 데이터를 JSON 파일로 다운로드해야 합니다
2. WHEN 소설을 저장할 때 THEN 시스템은 소설 제목과 현재 날짜를 포함한 파일명을 자동 생성해야 합니다
3. WHEN 저장 파일이 생성될 때 THEN 시스템은 소설 기본 정보, 해당 소설의 모든 장면 데이터, 해당 소설에 속한 등장인물 정보, 생성된 이미지를 모두 포함해야 합니다
4. WHEN 소설 데이터를 저장할 때 THEN 시스템은 소설별로 독립적인 데이터 구조를 유지해야 합니다

### Requirement 2

**User Story:** 사용자로서, 저장된 소설 파일을 불러와서 작업을 계속하고 싶습니다. 그래야 이전에 작업한 소설을 이어서 편집할 수 있습니다.

#### Acceptance Criteria

1. WHEN 사용자가 "소설 불러오기" 버튼을 클릭 THEN 시스템은 파일 선택 다이얼로그를 표시해야 합니다
2. WHEN 사용자가 유효한 소설 파일을 선택 THEN 시스템은 파일 내용을 파싱하여 소설 데이터를 복원해야 합니다
3. WHEN 소설이 성공적으로 불러와질 때 THEN 시스템은 해당 소설의 모든 장면, 등장인물, 이미지 데이터를 정확히 복원해야 합니다
4. WHEN 소설을 불러올 때 THEN 시스템은 기존 소설 목록에 새로운 소설로 추가해야 합니다
5. IF 파일 형식이 올바르지 않거나 손상된 경우 THEN 시스템은 적절한 오류 메시지를 표시해야 합니다
6. IF 동일한 제목의 소설이 이미 존재하는 경우 THEN 시스템은 사용자에게 덮어쓰기 또는 새 이름으로 저장할지 선택하게 해야 합니다

### Requirement 3

**User Story:** 사용자로서, 개별 장면이나 등장인물을 별도 파일로 저장하고 싶습니다. 그래야 다른 프로젝트에서 재사용할 수 있습니다.

#### Acceptance Criteria

1. WHEN 사용자가 장면 편집 화면에서 "장면 내보내기" 버튼을 클릭 THEN 시스템은 해당 장면의 모든 데이터를 JSON 파일로 저장해야 합니다
2. WHEN 사용자가 등장인물 관리 화면에서 "인물 내보내기" 버튼을 클릭 THEN 시스템은 해당 인물의 정보와 이미지를 파일로 저장해야 합니다
3. WHEN 개별 요소를 내보낼 때 THEN 시스템은 해당 요소의 타입을 파일명에 포함해야 합니다

### Requirement 4

**User Story:** 사용자로서, 저장된 개별 장면이나 등장인물 파일을 현재 프로젝트에 가져오고 싶습니다. 그래야 이전에 만든 자료를 재활용할 수 있습니다.

#### Acceptance Criteria

1. WHEN 사용자가 "장면 가져오기" 버튼을 클릭 THEN 시스템은 장면 파일을 선택할 수 있는 다이얼로그를 표시해야 합니다
2. WHEN 사용자가 "등장인물 가져오기" 버튼을 클릭 THEN 시스템은 등장인물 파일을 선택할 수 있는 다이얼로그를 표시해야 합니다
3. WHEN 가져온 데이터가 현재 프로젝트에 추가될 때 THEN 시스템은 ID 충돌을 방지하기 위해 새로운 고유 ID를 생성해야 합니다
4. IF 가져온 파일의 형식이 올바르지 않은 경우 THEN 시스템은 적절한 오류 메시지를 표시해야 합니다

### Requirement 5

**User Story:** 사용자로서, 생성된 이미지들을 개별적으로 저장하고 싶습니다. 그래야 외부 프로그램에서 사용하거나 공유할 수 있습니다.

#### Acceptance Criteria

1. WHEN 사용자가 생성된 이미지 위에서 우클릭 THEN 시스템은 "이미지 저장" 옵션을 포함한 컨텍스트 메뉴를 표시해야 합니다
2. WHEN 사용자가 "이미지 저장"을 선택 THEN 시스템은 이미지를 PNG 형식으로 다운로드해야 합니다
3. WHEN 이미지를 저장할 때 THEN 시스템은 장면명 또는 캐릭터명을 포함한 의미있는 파일명을 생성해야 합니다

### Requirement 6

**User Story:** 사용자로서, 전체 소설 라이브러리를 한 번에 백업하고 복원하고 싶습니다. 그래야 모든 소설 데이터의 손실을 방지하고 여러 기기에서 작업할 수 있습니다.

#### Acceptance Criteria

1. WHEN 사용자가 "전체 라이브러리 백업" 기능을 실행 THEN 시스템은 모든 소설과 각 소설에 속한 등장인물, 장면 데이터를 하나의 압축 파일로 저장해야 합니다
2. WHEN 사용자가 백업 파일을 복원 THEN 시스템은 기존 데이터와 병합할지 덮어쓸지 선택할 수 있는 옵션을 제공해야 합니다
3. WHEN 백업이 완료될 때 THEN 시스템은 백업된 소설 수, 총 장면 수, 등장인물 수와 파일 크기 정보를 사용자에게 표시해야 합니다
4. WHEN 라이브러리를 복원할 때 THEN 시스템은 각 소설의 계층 구조를 정확히 유지해야 합니다

### Requirement 7

**User Story:** 사용자로서, 저장 및 불러오기 과정에서 진행 상황을 확인하고 싶습니다. 그래야 대용량 파일 처리 시에도 안심하고 기다릴 수 있습니다.

#### Acceptance Criteria

1. WHEN 파일 저장이나 불러오기가 진행 중일 때 THEN 시스템은 진행률 표시기를 보여줘야 합니다
2. WHEN 대용량 이미지가 포함된 파일을 처리할 때 THEN 시스템은 현재 처리 중인 항목명을 표시해야 합니다
3. WHEN 저장이나 불러오기가 완료될 때 THEN 시스템은 성공 메시지와 함께 처리된 항목 수를 표시해야 합니다
#
## Requirement 8

**User Story:** 사용자로서, 소설별로 등장인물을 관리하고 싶습니다. 그래야 각 소설의 캐릭터들이 섞이지 않고 체계적으로 관리할 수 있습니다.

#### Acceptance Criteria

1. WHEN 사용자가 새로운 등장인물을 생성할 때 THEN 시스템은 해당 인물이 어느 소설에 속하는지 지정할 수 있어야 합니다
2. WHEN 사용자가 등장인물 목록을 볼 때 THEN 시스템은 소설별로 그룹화하여 표시해야 합니다
3. WHEN 장면에서 캐스팅을 선택할 때 THEN 시스템은 현재 소설에 속한 등장인물만 표시해야 합니다
4. WHEN 소설을 삭제할 때 THEN 시스템은 해당 소설에 속한 모든 등장인물과 장면도 함께 삭제할지 확인해야 합니다

### Requirement 9

**User Story:** 사용자로서, 소설 간에 등장인물이나 장면을 복사하거나 이동하고 싶습니다. 그래야 시리즈물이나 스핀오프 작품을 효율적으로 관리할 수 있습니다.

#### Acceptance Criteria

1. WHEN 사용자가 등장인물을 다른 소설로 복사할 때 THEN 시스템은 대상 소설을 선택할 수 있는 인터페이스를 제공해야 합니다
2. WHEN 등장인물을 복사할 때 THEN 시스템은 이미지와 모든 속성을 함께 복사해야 합니다
3. WHEN 장면을 다른 소설로 이동할 때 THEN 시스템은 해당 장면의 캐스팅 정보가 대상 소설에 맞게 조정되는지 확인해야 합니다
4. IF 복사하려는 등장인물과 동일한 이름이 대상 소설에 이미 존재하는 경우 THEN 시스템은 사용자에게 덮어쓰기 또는 새 이름 생성을 선택하게 해야 합니다
###
 Requirement 10

**User Story:** 사용자로서, 나노바나나 API를 통해 고품질 이미지를 생성하고 싶습니다. 그래야 더 나은 품질의 소설 삽화를 만들 수 있습니다.

#### Acceptance Criteria

1. WHEN 사용자가 이미지 생성을 요청할 때 THEN 시스템은 나노바나나 API를 호출해야 합니다
2. WHEN 나노바나나 API 호출이 실패할 때 THEN 시스템은 적절한 오류 메시지를 표시하고 대안을 제시해야 합니다
3. WHEN 이미지가 성공적으로 생성될 때 THEN 시스템은 생성된 이미지를 압축하여 저장 공간을 최적화해야 합니다
4. WHEN 나노바나나 API 설정을 변경할 때 THEN 시스템은 API 키와 모델 설정을 관리할 수 있는 인터페이스를 제공해야 합니다

### Requirement 11

**User Story:** 사용자로서, 제미나이 AI를 통해 장면에 맞는 이미지 프롬프트를 자동 생성하고 싶습니다. 그래야 더 정확하고 상세한 이미지 생성 지시문을 만들 수 있습니다.

#### Acceptance Criteria

1. WHEN 사용자가 "프롬프트 자동 생성" 버튼을 클릭할 때 THEN 시스템은 제미나이 API를 호출하여 프롬프트를 생성해야 합니다
2. WHEN 프롬프트를 생성할 때 THEN 시스템은 장면의 지문, 대사, 등장인물, 미장센 정보를 모두 활용해야 합니다
3. WHEN 제미나이가 프롬프트를 생성할 때 THEN 시스템은 나노바나나 API에 최적화된 형식으로 프롬프트를 구성해야 합니다
4. IF 제미나이 API 호출이 실패하는 경우 THEN 시스템은 기본 템플릿을 사용하여 프롬프트를 생성해야 합니다### 
Requirement 12

**User Story:** 사용자로서, 전체 대본을 분석하여 등장인물을 먼저 생성하고, 각 장면에서 동일한 등장인물의 일관된 외모를 유지하고 싶습니다. 그래야 소설 전체에서 캐릭터의 시각적 일관성을 보장할 수 있습니다.

#### Acceptance Criteria

1. WHEN 사용자가 "AI로 등장인물 생성" 기능을 실행할 때 THEN 시스템은 제미나이를 통해 대본에서 등장인물을 추출하고 각 인물의 상세한 외모 묘사를 생성해야 합니다
2. WHEN 등장인물이 생성될 때 THEN 시스템은 나노바나나 API를 통해 각 인물의 기준 이미지(reference image)를 생성해야 합니다
3. WHEN 장면 이미지를 생성할 때 THEN 시스템은 해당 장면에 등장하는 인물들의 기준 이미지를 나노바나나 API에 함께 전달해야 합니다
4. WHEN 나노바나나에 이미지 생성을 요청할 때 THEN 시스템은 등장인물의 기준 이미지와 장면 프롬프트를 조합하여 일관된 캐릭터 외모를 유지해야 합니다
5. WHEN 등장인물의 기준 이미지가 변경될 때 THEN 시스템은 해당 인물이 등장하는 모든 장면 이미지를 다시 생성할지 사용자에게 확인해야 합니다

### Requirement 13

**User Story:** 사용자로서, 장면별로 등장인물의 포즈나 표정을 다르게 하면서도 기본 외모는 일관되게 유지하고 싶습니다. 그래야 같은 인물이지만 상황에 맞는 다양한 표현을 할 수 있습니다.

#### Acceptance Criteria

1. WHEN 장면 이미지를 생성할 때 THEN 시스템은 등장인물의 기준 외모 + 장면별 상황 묘사를 조합한 프롬프트를 생성해야 합니다
2. WHEN 나노바나나 API에 요청할 때 THEN 시스템은 캐릭터 일관성 유지를 위한 적절한 파라미터를 설정해야 합니다
3. WHEN 사용자가 장면의 캐스팅을 변경할 때 THEN 시스템은 새로운 등장인물의 기준 이미지를 반영하여 이미지 재생성을 제안해야 합니다
4. IF 등장인물의 기준 이미지가 없는 경우 THEN 시스템은 해당 인물의 이미지를 먼저 생성하도록 안내해야 합니다